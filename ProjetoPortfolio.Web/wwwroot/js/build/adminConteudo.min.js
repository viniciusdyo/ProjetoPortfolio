"use strict";(self.webpackChunkwwwroot=self.webpackChunkwwwroot||[]).push([["adminConteudo"],{"./js/adminConteudo.js":(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{eval('/* harmony import */ var _fetchHelper__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fetchHelper */ "./js/fetchHelper.js");\n\ufeff\r\n\r\n\r\nconst adminConteudo = function () {\r\n\r\n    const conteudosRoot = document.querySelector(\'#conteudos-root\');\r\n    const mainContent = document.querySelector(\'#mainContent\');\r\n\r\n    async function conteudosInit() {\r\n        const data = await (0,_fetchHelper__WEBPACK_IMPORTED_MODULE_0__.fetchGet)(\'AdminConteudo/ListarConteudoAdmin\');\r\n\r\n        if (data != null || data != undefined || data.length > 0) {\r\n            const conteudos = data.conteudos;\r\n            const categorias = data.categorias;\r\n\r\n            listarConteudos(conteudos, categorias);\r\n        } else {\r\n            nenhumEncontrado();\r\n        }\r\n    };\r\n\r\n    function nenhumEncontrado() {\r\n        var titulo = document.createElement(\'h2\');\r\n        titulo.textContent = "Nenhum conteúdo encontrado!"\r\n        titulo.classList.add(\'text-white\');\r\n        conteudosRoot.classList.remove(\'col-md-4\');\r\n        conteudosRoot.appendChild(titulo);\r\n    };\r\n\r\n    function listarConteudos(conteudos, categorias) {\r\n        conteudos.forEach(conteudo => {\r\n            var card = criaCardLista(conteudo);\r\n            var modalEditar = criaModalEditar(conteudo, categorias);\r\n            mainContent.appendChild(modalEditar);\r\n            conteudosRoot.appendChild(card);\r\n\r\n            var btnSalvarAlteracoes = modalEditar.querySelector(\'.btn-salvar\');\r\n            btnSalvarAlteracoes.addEventListener(\'click\', function () {\r\n                salvarAlteracoes(modalEditar);\r\n            });\r\n        })\r\n    };\r\n\r\n    function criaCardLista(conteudo) {\r\n        const cardHtml = `\r\n            <div class="card bg-dark-darker text-white border-primary">\r\n                <h5 class="card-header border-primary text-primary"> ${conteudo.titulo}</h5>\r\n                <div class="card-body">\r\n                    <h5 class="card-title"><b>Nome:</b> ${conteudo.nome}</h5>\r\n                    <p class="card-text"><b>Conteúdo:</b> ${conteudo.conteudo}</p>\r\n                    <div class="d-flex align-content-center">\r\n                        <p class="card-text me-2">\r\n                            <b>Categoria:</b>\r\n                        </p> \r\n                        <a class="text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">\r\n                            ${conteudo.categoriaConteudoModel.nome}\r\n                        </a>\r\n                        <ul class="dropdown-menu dropdown-menu-dark py-3">\r\n                            <li>\r\n                                <p class="px-2 py-0 my-0 text-secondary">Descrição</p>\r\n                                <p class="px-2 py-0 my-0 text-white">${conteudo.categoriaConteudoModel.descricao}</p>\r\n                            </li>\r\n                        </ul>                       \r\n                    </div>                    \r\n                </div>\r\n                <div class="card-body ativos-div border-top border-primary">\r\n                    <div id="${conteudo.nomeNormalizado}-ativos">\r\n                        <h4>Ativos</h4>\r\n                    </div>\r\n                </div>\r\n                <div id="card-footer-${conteudo.nomeNormalizado}" class="card-footer border-primary">\r\n                    <a id="btn-editar-${conteudo.nomeNormalizado}" data-bs-toggle="modal" data-bs-target="#modal-editar-${conteudo.nomeNormalizado}" class="btn btn-primary text-white">Editar</a>\r\n                    <a class="btn btn-danger text-white btn-excluir-conteudo" data-bs-toggle="modal" data-bs-target="#modal-remover-${conteudo.nomeNormalizado}">Excluir</a>\r\n                </div>\r\n            </div>`;\r\n\r\n        var card = document.createElement(\'div\');\r\n        card.classList.add(\'col\');\r\n        card.innerHTML = cardHtml;\r\n\r\n        console.log(conteudo);\r\n\r\n        var ativos = conteudo.ativosConteudo;\r\n        var ativosDiv = card.querySelector(\'.ativos-div\');\r\n        if (ativos.length == 0 || ativos == null) {\r\n            ativosDiv.remove();\r\n        } else {\r\n            ativos.forEach(ativo => {\r\n                console.log(ativo)\r\n            });\r\n        }\r\n\r\n        return card;\r\n    };\r\n\r\n    function criaModalEditar(conteudo, categorias) {\r\n\r\n        var modalContent = `<div class="modal-dialog">\r\n            <div id="editar-root" class="modal-content">\r\n                <div class="modal-header">\r\n                    <h1 id="modal-editar-${conteudo.nomeNormalizado}-label" class="modal-title fs-5">Editar ${conteudo.titulo}</h1>\r\n                    <button type="button" class="btn-fechar" data-bs-dismiss="modal" aria-label="Close"></button>\r\n                </div>\r\n                <div class="modal-body">\r\n                    <form id="editar-conteudo-${conteudo.nomeNormalizado}-form" data-bs-theme="portfolio-dark" class="row row-cols-1 g-3 form-editar-conteudo " autocomplete="off">\r\n                        <div class="text-danger"></div>\r\n                        <input name="id" value="${conteudo.id}" type="hidden" />\r\n                        <div class="col">\r\n                            <div class="form-floating">\r\n                                <input type="text"  placeholder="Título" class="form-control text-white" name="titulo" value="${conteudo.titulo}" />\r\n                                <label class="control-label text-white">Título</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col">\r\n                            <div class="form-floating">\r\n                                <input type="text" placeholder="Nome" class="form-control text-white" name="nome" value="${conteudo.nome}" />\r\n                                <span class="text-danger"></span>\r\n                                <label class="control-label text-white">Nome</label>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col">\r\n                            <div class="form-floating">\r\n                                <textarea type="text" maxlength="2500" placeholder="Conteúdo" class="form-control text-white" name="conteudo">${conteudo.conteudo}</textarea>\r\n                                <label class="control-label text-white">Conteúdo</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col">\r\n                            <select id="${conteudo.nomeNormalizado}-select" class="form-select mb-3" name="categoriaId">\r\n                                \r\n                            </select>\r\n                        </div>\r\n\r\n                        <div class="col">\r\n                            <p class="text-white fw-bold">\r\n                                Ativos\r\n                            </p>\r\n                            <a id="${conteudo.nomeNormalizado}-btn-add-ativo" class="btn btn-success btn-adicionar-ativo text-white">Adicionar ativo</a>\r\n                        </div>\r\n\r\n                        <div id="${conteudo.nomeNormalizado}-inputs-ativos" class="ativo-div-inputs" name="ativosConteudo">\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button type="button" class="btn btn-secondary text-white" data-bs-dismiss="modal">Fechar</button>\r\n                    <a class="btn btn-success text-white btn-salvar">Salvar Alterações</a>\r\n                </div>\r\n            </div>\r\n        </div>`;\r\n\r\n        var modal = document.createElement(\'div\');\r\n\r\n        modal.id = `modal-editar-${conteudo.nomeNormalizado}`;\r\n        modal.tabIndex = -1;\r\n        modal.ariaLabel = `#modal-editar-${conteudo.nomeNormalizado}-label`;\r\n        modal.ariaHidden = true;\r\n        modal.classList.add(\'modal-editar\', \'modal\', \'fade\');\r\n        modal.innerHTML = modalContent;\r\n\r\n        var selectCategorias = modal.querySelector(\'select\');\r\n\r\n        if (categorias.length > 0 && categorias != null && categorias != undefined) {\r\n            categorias.forEach(categoria => {\r\n                var option = document.createElement(\'option\');\r\n                option.value = categoria.categoriaId;\r\n                option.innerText = categoria.nome;\r\n                if (categoria.categoriaId == conteudo.categoriaId) {\r\n                    option.selected = true;\r\n                };\r\n                selectCategorias.appendChild(option);\r\n            });\r\n        };\r\n\r\n        var btnAdicionarAtivo = modal.querySelector(`#${conteudo.nomeNormalizado}-btn-add-ativo`);\r\n        var ativos = conteudo.ativosConteudo;\r\n        var ativosDiv = modal.querySelector(`#${conteudo.nomeNormalizado}-inputs-ativos`);\r\n\r\n        if (ativos.length > 0 && ativos != null && ativos != undefined) {\r\n            ativos.forEach(ativo => {\r\n                ativosDiv.appendChild(adicionarAtivo(ativo));\r\n            });\r\n        }\r\n\r\n        btnAdicionarAtivo.addEventListener(\'click\', function () {\r\n            ativosDiv.appendChild(adicionarAtivo(null));\r\n        });\r\n\r\n        return modal;\r\n    };\r\n\r\n    function adicionarAtivo(ativoData) {\r\n        var ativo;\r\n        var ativoHtml = ``;\r\n\r\n        console.log(ativoData)\r\n\r\n        if (ativoData == null) {\r\n            console.log(\'ativo\')\r\n            ativo = document.createElement(\'div\');\r\n            ativoHtml = `<a class="btn btn-danger btn-remover-ativo text-white my-3">Remover</a>\r\n            <input type="hidden" class="form-control text-white" name="ativoId" value="00000000-0000-0000-0000-000000000000" />\r\n            <div class="col-12 mb-3">\r\n                <div class="form-floating">\r\n                    <input type="text"  placeholder="Nome Ativo" class="form-control text-white" name="nomeAtivo" value="" />\r\n                    <label class="control-label text-white">Nome Ativo</label>\r\n                    <span class="text-danger"></span>\r\n                </div>\r\n            </div>\r\n            <div class="col-12 mb-3">\r\n                <div class="form-floating">\r\n                    <input type="text"  placeholder="Descrição" class="form-control text-white" name="descricao" value="" />\r\n                    <label class="control-label text-white">Descrição</label>\r\n                    <span class="text-danger"></span>\r\n                </div>\r\n            </div>\r\n            <div class="col-12 mb-3">\r\n                <div class="form-floating">\r\n                    <input type="text"  placeholder="Valor" class="form-control text-white" name="valor" value="" />\r\n                    <label class="control-label text-white">Valor</label>\r\n                    <span class="text-danger"></span>\r\n                </div>\r\n            </div>\r\n            <div class="col-12 mb-3">\r\n                <select class="form-select mb-3"  name="tipoAtivo">\r\n                    <option value="1">Link</option>\r\n                    <option value="2">Imagem</option>\r\n                </select>\r\n            </div>`;\r\n            ativo.classList.add(\'form-ativo\', \'col-12\');\r\n            ativo.innerHTML = ativoHtml;\r\n        } else {\r\n            ativo = document.createElement(\'div\');\r\n            ativoHtml = `<a class="btn btn-danger btn-remover-ativo text-white my-3">Remover</a>\r\n            <input type="hidden" class="form-control text-white" name="ativoId" value="${ativoData.ativoId}" />\r\n            <div class="col-12 mb-3">\r\n                <div class="form-floating">\r\n                    <input type="text"  placeholder="Nome Ativo" class="form-control text-white" name="nomeAtivo" value="${ativoData.nomeAtivo}" />\r\n                    <label class="control-label text-white">Nome Ativo</label>\r\n                    <span class="text-danger"></span>\r\n                </div>\r\n            </div>\r\n            <div class="col-12 mb-3">\r\n                <div class="form-floating">\r\n                    <input type="text"  placeholder="Descrição" class="form-control text-white" name="descricao" value="${ativoData.descricao}" />\r\n                    <label class="control-label text-white">Descrição</label>\r\n                    <span class="text-danger"></span>\r\n                </div>\r\n            </div>\r\n            <div class="col-12 mb-3">\r\n                <div class="form-floating">\r\n                    <input type="text"  placeholder="Valor" class="form-control text-white" name="valor" value="${ativoData.valor}" />\r\n                    <label class="control-label text-white">Valor</label>\r\n                    <span class="text-danger"></span>\r\n                </div>\r\n            </div>\r\n            <div class="col-12 mb-3">\r\n                <select class="form-select mb-3"  name="tipoAtivo">\r\n                    <option value="1">Link</option>\r\n                    <option value="2">Imagem</option>\r\n                </select>\r\n            </div>`;\r\n            ativo.classList.add(\'form-ativo\', \'col-12\');\r\n            ativo.innerHTML = ativoHtml;\r\n\r\n            var select = ativo.querySelector(\'select\');\r\n            var options = select.querySelectorAll(\'option\');\r\n\r\n            options.forEach(opt => {\r\n                if (parseInt(opt.value) == parseInt(ativoData.tipoAtivo)) {\r\n                    opt.selected = true;\r\n                }\r\n            });\r\n        }\r\n\r\n        removerAtivo(ativo);\r\n        return ativo;\r\n    };\r\n\r\n    function removerAtivo(ativo) {\r\n        var btnRemoverAtivo = ativo.querySelector(\'.btn-remover-ativo\');\r\n\r\n        if (btnRemoverAtivo != undefined && btnRemoverAtivo != null) {\r\n            btnRemoverAtivo.addEventListener(\'click\', function () {\r\n                ativo.remove()\r\n            });\r\n        }\r\n    };\r\n\r\n    function salvarAlteracoes(modal) {\r\n        const form = modal.querySelector(\'form\');\r\n        const ativos = form.querySelectorAll(\'.form-ativo\');\r\n        const arrAtivos = [];\r\n        const objAtivos = {};\r\n        let count = 0;\r\n        if (ativos.length > 0 && ativos != null && ativos != undefined) {\r\n            ativos.forEach(ativo => {\r\n                console.log(ativo)\r\n                const objAtivo = {};\r\n                var inputs = ativo.querySelectorAll(\'input\');\r\n\r\n                if (inputs.length > 0 && inputs != null && inputs != undefined) {\r\n                    inputs.forEach(input => {\r\n                        objAtivo[input.name] = input.value;\r\n                        console.log(objAtivo)\r\n                    })\r\n                }\r\n\r\n                var selectAtivo = ativo.querySelector(\'select\');\r\n\r\n                if (selectAtivo != null && selectAtivo != undefined) {\r\n                    objAtivo[selectAtivo.name] = parseInt(selectAtivo.value)\r\n                }\r\n\r\n                arrAtivos[count] = objAtivo;\r\n                count += 1;\r\n            })\r\n        }\r\n\r\n        const formData = new FormData(form);\r\n        if (formData != null && formData != undefined) {\r\n            formData.forEach((value, key) => {\r\n                objAtivos[key] = value\r\n            });\r\n        }\r\n\r\n        if (arrAtivos.length > 0) {\r\n            objAtivos[\'ativosConteudo\'] = arrAtivos;\r\n        }\r\n\r\n        delete objAtivos.ativoId;\r\n        delete objAtivos.descricao;\r\n        delete objAtivos.valor;\r\n        delete objAtivos.nomeAtivo;\r\n        delete objAtivos.tipoAtivo;\r\n        console.log(objAtivos)\r\n        ;(0,_fetchHelper__WEBPACK_IMPORTED_MODULE_0__.fetchPost)(\'AdminConteudo/Editar\', objAtivos);\r\n        location.reload()\r\n    };\r\n\r\n    function init() {\r\n        conteudosInit()\r\n    };\r\n\r\n    init();\r\n};\r\n\r\nadminConteudo();\n\n//# sourceURL=webpack://wwwroot/./js/adminConteudo.js?')},"./js/fetchHelper.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchGet: () => (/* binding */ fetchGet),\n/* harmony export */   fetchPost: () => (/* binding */ fetchPost)\n/* harmony export */ });\n\r\nconst fetchGet = async (url) => {\r\n    var response = await fetch(url, {\r\n        method: 'GET'\r\n    });\r\n\r\n    var result = await response.json();\r\n\r\n    return result;\r\n}\r\n\r\nconst fetchPost = async (url, body) => {\r\n    var response = await fetch(url, {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            \"Content-type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(body)\r\n    }).then(result => result)\r\n\r\n    return response;\r\n}\r\n\n\n//# sourceURL=webpack://wwwroot/./js/fetchHelper.js?")}},n=>{var o;o="./js/adminConteudo.js",n(n.s=o)}]);