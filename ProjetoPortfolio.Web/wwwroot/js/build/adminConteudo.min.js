"use strict";(self.webpackChunkwwwroot=self.webpackChunkwwwroot||[]).push([["adminConteudo"],{"./js/adminConteudo.js":(__unused_webpack_module,__unused_webpack___webpack_exports__,__webpack_require__)=>{eval('/* harmony import */ var _fetchHelper__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fetchHelper */ "./js/fetchHelper.js");\n\ufeff\r\n\r\nconst adminConteudo = () => {\r\n\r\n\r\n\r\n    const listarConteudos = async () => {\r\n        const conteudoViewModel = await (0,_fetchHelper__WEBPACK_IMPORTED_MODULE_0__.fetchGet)(\'AdminConteudo/ListarConteudoAdmin\');\r\n        const conteudos = conteudoViewModel.conteudos;\r\n        const categorias = conteudoViewModel.categorias;\r\n        const conteudoRoot = document.querySelector(\'#conteudos\');\r\n        const main = document.querySelector(\'main\');\r\n        //console.log(conteudos);\r\n\r\n        conteudos.forEach(i => {\r\n            const card = `<div class="col-4">\r\n            <div class="card bg-dark-darker text-white border-primary">\r\n                <h5 class="card-header border-primary text-primary"> ${i.titulo}</h5>\r\n                <div class="card-body">\r\n                    <h5 class="card-title"><b>Nome:</b> ${i.nome}</h5>\r\n                    <p class="card-text"><b>Conteúdo:</b> ${i.conteudo}</p>\r\n                    <div class="d-flex align-content-center">\r\n                        <p class="card-text me-2">\r\n                            <b>Categoria:</b>\r\n                        </p> \r\n                        <a class="text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">\r\n                            ${i.categoriaConteudoModel.nome}\r\n                        </a>\r\n                        <ul class="dropdown-menu dropdown-menu-dark py-3">\r\n                            <li>\r\n                                <p class="px-2 py-0 my-0 text-secondary">Descrição</p>\r\n                                <p class="px-2 py-0 my-0 text-white">${i.categoriaConteudoModel.descricao}</p>\r\n                            </li>\r\n                        </ul>\r\n                        \r\n                    </div>\r\n                    \r\n                    \r\n                </div>\r\n                <div class="card-body border-top border-primary">\r\n                    <div id="${i.nomeNormalizado}-ativos">\r\n                        <h4>Ativos</h4>\r\n\r\n                    </div>\r\n                </div>\r\n                <div id="card-footer-${i.nomeNormalizado}" class="card-footer border-primary">\r\n                    <a id="btn-editar-${i.nomeNormalizado}" data-bs-toggle="modal" data-bs-target="#editar-${i.nomeNormalizado}-modal" class="btn btn-primary text-white">Editar</a>\r\n                   \r\n                </div>\r\n            </div>\r\n        </div>`;\r\n\r\n            conteudoRoot.innerHTML += card;\r\n            i.ativosConteudo.forEach(e => {\r\n                var ativoNome = document.createElement(\'p\');\r\n                ativoNome.innerHTML = `<b>Nome:</b> ${e.nomeAtivo}`;\r\n                var ativoTipo = document.createElement(\'p\');\r\n                ativoTipo.innerHTML = `<b>Tipo:</b> ${e.tipoAtivo}`;\r\n                var ativoDescricao = document.createElement(\'p\');\r\n                ativoDescricao.innerHTML = `<b>Descricao:</b> ${e.descricao}`;\r\n                var ativosDiv = conteudoRoot.querySelector(`#${i.nomeNormalizado}-ativos`);\r\n                ativosDiv.appendChild(ativoNome);\r\n                ativosDiv.appendChild(ativoDescricao);\r\n                ativosDiv.appendChild(ativoTipo);\r\n            })\r\n\r\n        });\r\n\r\n        conteudos.forEach(c => {\r\n            var modal = criarModalEditar(c);\r\n            main.innerHTML += modal;\r\n            var modalForm = document.querySelector(`.${c.nomeNormalizado}-form`);\r\n            var formSelect = document.querySelector(`#${c.nomeNormalizado}-select`);\r\n            var divInputAtivos = modalForm.querySelector(`#${c.nomeNormalizado}-inputs-ativos`);\r\n\r\n\r\n            categorias.forEach(o => {\r\n                var optSelect = document.createElement(\'option\');\r\n\r\n                optSelect.value = `${o.categoriaId}`;\r\n                optSelect.innerText = `${o.nome}`;\r\n                if (c.categoriaId == o.categoriaId) {\r\n                    optSelect.selected = true;\r\n                }\r\n                formSelect.appendChild(optSelect);\r\n            });\r\n\r\n            c.ativosConteudo.forEach(e => {\r\n                var ativos = `\r\n                <div id="${e.nome}-div" class="form-ativo col-12">\r\n                        <a class="btn btn-danger btn-remover-ativo text-white my-3">Remover</a>\r\n                        <input type="hidden" class="form-control text-white" name="ativoId" value="${e.ativoId}" />\r\n                        <div class="col-12 mb-3">\r\n                            <div class="form-floating">\r\n                                <input type="text"  placeholder="Nome Ativo" class="form-control text-white" name="nomeAtivo" value="${e.nomeAtivo}" />\r\n                                <label class="control-label text-white">Nome Ativo</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col-12 mb-3">\r\n                            <div class="form-floating">\r\n                                <input type="text"  placeholder="Descrição" class="form-control text-white" name="descricao" value="${e.descricao}" />\r\n                                <label class="control-label text-white">Descrição</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col-12 mb-3">\r\n                            <div class="form-floating">\r\n                                <input type="text"  placeholder="Valor" class="form-control text-white" name="valor" value="${e.valor}" />\r\n                                <label class="control-label text-white">Valor</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col-12 mb-3">\r\n                            <select class="form-select mb-3"  name="tipoAtivo">\r\n                                <option value="1">Link</option>\r\n                                <option value="2">Imagem</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    `;\r\n\r\n\r\n                divInputAtivos.innerHTML += ativos;\r\n\r\n            })\r\n            c.ativosConteudo.forEach(a => {\r\n                adicionarAtivo();\r\n                removerAtivo();\r\n            })\r\n        });\r\n\r\n        modalEditarSubmit();\r\n    }\r\n\r\n    const removerAtivo = () => {\r\n        var btnRemover = document.querySelectorAll(\'.btn-remover-ativo\');\r\n        btnRemover.forEach(b => {\r\n            b.addEventListener(\'click\', e => {\r\n                e.preventDefault();\r\n                b.closest(\'.form-ativo\').remove();\r\n            })\r\n        })\r\n    }\r\n\r\n    const adicionarAtivo = () => {\r\n        var btnAdicionar = document.querySelectorAll(\'.btn-adicionar-ativo\');\r\n\r\n        btnAdicionar.forEach(b => {\r\n            var ativo = `\r\n                <div class="form-ativo col-12">\r\n                        <a class="btn btn-danger btn-remover-ativo text-white my-3">Remover</a>\r\n                        <input type="hidden" class="form-control text-white" name="ativoId" value="00000000-0000-0000-0000-000000000000"/>\r\n                        <div class="col-12 mb-3">\r\n                            <div class="form-floating">\r\n                                <input type="text"  placeholder="Nome Ativo" class="form-control text-white" name="nomeAtivo" />\r\n                                <label class="control-label text-white">Nome Ativo</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col-12 mb-3">\r\n                            <div class="form-floating">\r\n                                <input type="text"  placeholder="Descrição" class="form-control text-white" name="descricao" />\r\n                                <label class="control-label text-white">Descrição</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col-12 mb-3">\r\n                            <div class="form-floating">\r\n                                <input type="text"  placeholder="Valor" class="form-control text-white" name="valor" />\r\n                                <label class="control-label text-white">Valor</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col-12 mb-3">\r\n                            <select class="form-select mb-3"  name="tipoAtivo">\r\n                                <option value="1">Link</option>\r\n                                <option value="2">Imagem</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    `;\r\n            var btnParent = b.parentElement;\r\n            var formBtn = btnParent.parentElement;\r\n            var divAtivos = formBtn.querySelector(\'.ativo-div-inputs\');\r\n            b.addEventListener(\'click\', e => {\r\n                e.preventDefault();\r\n                divAtivos.innerHTML += ativo;\r\n                removerAtivo();\r\n            })\r\n\r\n        });\r\n    }\r\n\r\n    const modalEditarSubmit = () => {\r\n        var formEditar = document.querySelectorAll(\'.form-editar-conteudo\');\r\n\r\n        formEditar.forEach(form => {\r\n            var formParent = form.parentElement;\r\n            var btnSalvar = formParent.parentElement.lastElementChild.lastElementChild;\r\n\r\n\r\n            btnSalvar.addEventListener(\'click\', e => {\r\n                e.preventDefault()\r\n                var ativos = form.querySelectorAll(\'.form-ativo\');\r\n                var ativosArr = []\r\n                var count = 0\r\n                ativos.forEach(a => {\r\n\r\n                    var ativo = {}\r\n                    a.querySelectorAll(\'input\').forEach(i => {\r\n                        ativo[i.name] = i.value\r\n                        console.log(i.name + \' \' + i.value)\r\n                    });\r\n                    var selectTipoAtivo = a.querySelector(\'select\');\r\n                    ativo[selectTipoAtivo.name] = parseInt(selectTipoAtivo.value)\r\n                    //console.log(ativo)\r\n                    ativosArr[count] = ativo\r\n                    //console.log(ativosArr)\r\n                    count += 1\r\n                });\r\n\r\n                var formData = new FormData(form);\r\n                var object = {}\r\n                formData.forEach((value, key) => {\r\n\r\n                    object[key] = value\r\n                })\r\n                object[\'ativosConteudo\'] = ativosArr;\r\n                delete object.ativoId;\r\n                delete object.descricao;\r\n                delete object.valor;\r\n                delete object.nomeAtivo;\r\n                delete object.tipoAtivo;\r\n                (0,_fetchHelper__WEBPACK_IMPORTED_MODULE_0__.fetchPost)(\'AdminConteudo/Editar\', object)\r\n                form.submit()\r\n            })\r\n        });\r\n\r\n\r\n    }\r\n\r\n\r\n    const criarModalEditar = (conteudo) => {\r\n        var modal = `<div class="modal-editar modal fade" id="editar-${conteudo.nomeNormalizado}-modal" tabindex="-1" aria-labelledby="editar-${conteudo.nomeNormalizado}-modal" aria-hidden="true">\r\n        <div class="modal-dialog">\r\n            <div id="editar-root" class="modal-content">\r\n                <div class="modal-header">\r\n                    <h1 class="modal-title fs-5">Editar ${conteudo.titulo}</h1>\r\n                    <button type="button" class="btn-fechar" data-bs-dismiss="modal" aria-label="Close"></button>\r\n                </div>\r\n                <div class="modal-body">\r\n                    <form id="editar-conteudo-form" data-bs-theme="portfolio-dark" class="row row-cols-1 g-3 form-editar-conteudo ${conteudo.nomeNormalizado}-form" autocomplete="off">\r\n                        <div class="text-danger"></div>\r\n                        <input name="id" value="${conteudo.id}" type="hidden" />\r\n                        <div class="col">\r\n                            <div class="form-floating">\r\n                                <input type="text"  placeholder="Título" class="form-control text-white" name="titulo" value="${conteudo.titulo}" />\r\n                                <label class="control-label text-white">Título</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col">\r\n                            <div class="form-floating">\r\n                                <input type="text" placeholder="Nome" class="form-control text-white" name="nome" value="${conteudo.nome}" />\r\n                                <span class="text-danger"></span>\r\n                                <label class="control-label text-white">Nome</label>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col">\r\n                            <div class="form-floating">\r\n                                <textarea type="text" maxlength="2500" placeholder="Conteúdo" class="form-control text-white" name="conteudo">${conteudo.conteudo}</textarea>\r\n                                <label class="control-label text-white">Conteúdo</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col">\r\n                            <select id="${conteudo.nomeNormalizado}-select" class="form-select mb-3" name="categoriaId">\r\n                                \r\n                            </select>\r\n                        </div>\r\n\r\n                        <div class="col">\r\n                            <p class="text-white fw-bold">\r\n                                Ativos\r\n                            </p>\r\n                            <a id="${conteudo.nomeNormalizado}-btn-add-ativo" class="btn btn-success btn-adicionar-ativo text-white">Adicionar ativo</a>\r\n                        </div>\r\n\r\n                        <div id="${conteudo.nomeNormalizado}-inputs-ativos" class="ativo-div-inputs" name="ativosConteudo">\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button type="button" class="btn btn-secondary text-white" data-bs-dismiss="modal">Fechar</button>\r\n                    <a class="btn btn-success text-white btn-salvar">Salvar Alterações</a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>`;\r\n\r\n\r\n        return modal;\r\n    }\r\n    const adicionarConteudo = async () => {\r\n        const conteudoViewModel = await (0,_fetchHelper__WEBPACK_IMPORTED_MODULE_0__.fetchGet)(\'AdminConteudo/ListarConteudoAdmin\');\r\n        const categorias = conteudoViewModel.categorias;\r\n        mainContent.innerHTML += criarModalAdicionar();\r\n        const modalAdicionar = mainContent.querySelector(\'#adicionar-conteudo-modal\');\r\n        const formAdicionar = modalAdicionar.querySelector(\'#adicionar-conteudo-form\');\r\n        const selectCategoriaConteudo = formAdicionar.querySelector(\'#categoria-conteudo-select\');\r\n        adicionarAtivo()\r\n        categorias.forEach(c => {\r\n            var option = document.createElement(\'option\');\r\n            option.value = c.categoriaId;\r\n            option.text = c.nome;\r\n            selectCategoriaConteudo.appendChild(option)\r\n        });\r\n        const btnAdicionar = modalAdicionar.querySelector(\'.btn-adicionar-conteudo\');\r\n        btnAdicionar.addEventListener(\'click\', e => {\r\n            const formsAtivo = modalAdicionar.querySelectorAll(\'.form-ativo\');\r\n            const formData = new FormData(formAdicionar);\r\n            const obj = {};\r\n            const ativosArr = []\r\n            var count = 0;\r\n            if (formsAtivo != null) {\r\n                formsAtivo.forEach(f => {\r\n                    f.querySelectorAll(\'input\').forEach(i => {\r\n                        obj[i.name] = i.value;\r\n                    });\r\n                    var select = f.querySelector(\'select\');\r\n                    obj[select.name] = parseInt(select.value);\r\n                    ativosArr[count] = obj;\r\n                    count += 1;\r\n                });\r\n                console.log(obj);\r\n                console.log(ativosArr);\r\n            };\r\n            var object = {}\r\n            formData.forEach((value, key) => {\r\n\r\n                object[key] = value\r\n            })\r\n            if (ativosArr.length > 0) {\r\n                object[\'ativosConteudo\'] = ativosArr;\r\n            }\r\n\r\n            delete object.ativoId;\r\n            delete object.descricao;\r\n            delete object.valor;\r\n            delete object.nomeAtivo;\r\n            delete object.tipoAtivo;\r\n            (0,_fetchHelper__WEBPACK_IMPORTED_MODULE_0__.fetchPost)(\'AdminConteudo/Adicionar\', object);\r\n            formAdicionar.submit();\r\n        })\r\n    }\r\n\r\n    const criarModalAdicionar = () => {\r\n        var modal = `<div class="modal-editar modal fade" id="adicionar-conteudo-modal" tabindex="-1" aria-labelledby="adicionar-conteudo-modal" aria-hidden="true">\r\n        <div class="modal-dialog">\r\n            <div id="editar-root" class="modal-content">\r\n                <div class="modal-header">\r\n                    <h1 class="modal-title fs-5">Adicionar conteúdo</h1>\r\n                    <button type="button" class="btn-fechar" data-bs-dismiss="modal" aria-label="Close"></button>\r\n                </div>\r\n                <div class="modal-body">\r\n                    <form id="adicionar-conteudo-form" data-bs-theme="portfolio-dark" class="row row-cols-1 g-3 form-editar-conteudo " autocomplete="off">\r\n                        <div class="text-danger"></div>\r\n                        <input name="id" value="00000000-0000-0000-0000-000000000000" type="hidden" />\r\n                        <div class="col">\r\n                            <div class="form-floating">\r\n                                <input type="text"  placeholder="Título" class="form-control text-white" name="titulo" value="" />\r\n                                <label class="control-label text-white">Título</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col">\r\n                            <div class="form-floating">\r\n                                <input type="text" placeholder="Nome" class="form-control text-white" name="nome" value="" />\r\n                                <span class="text-danger"></span>\r\n                                <label class="control-label text-white">Nome</label>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col">\r\n                            <div class="form-floating">\r\n                                <textarea type="text" maxlength="2500" placeholder="Conteúdo" class="form-control text-white" name="conteudo"></textarea>\r\n                                <label class="control-label text-white">Conteúdo</label>\r\n                                <span class="text-danger"></span>\r\n                            </div>\r\n                        </div>\r\n                        <div class="col">\r\n                            <select id="categoria-conteudo-select" class="form-select mb-3" name="categoriaId">\r\n                                \r\n                            </select>\r\n                        </div>\r\n\r\n                        <div class="col">\r\n                            <p class="text-white fw-bold">\r\n                                Ativos\r\n                            </p>\r\n                            <a id="adicionar-btn-add-ativo" class="btn btn-success btn-adicionar-ativo text-white">Adicionar ativo</a>\r\n                        </div>\r\n\r\n                        <div id="adicionar-inputs-ativos" class="ativo-div-inputs" name="ativosConteudo">\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n                <div class="modal-footer">\r\n                    <button type="button" class="btn btn-secondary text-white" data-bs-dismiss="modal">Fechar</button>\r\n                    <a class="btn btn-success text-white btn-adicionar-conteudo">Adicionar</a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>`;\r\n        return modal;\r\n    };\r\n\r\n    const init = () => {\r\n        window.addEventListener(\'DOMContentLoaded\', (e) => {\r\n            e.preventDefault();\r\n            listarConteudos();\r\n            adicionarConteudo();\r\n            removerAtivo()\r\n        });\r\n    }\r\n\r\n    init();\r\n}\r\n\r\nadminConteudo();\r\n\r\n\n\n//# sourceURL=webpack://wwwroot/./js/adminConteudo.js?')},"./js/fetchHelper.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchGet: () => (/* binding */ fetchGet),\n/* harmony export */   fetchPost: () => (/* binding */ fetchPost)\n/* harmony export */ });\n\r\nconst fetchGet = async (url) => {\r\n    var response = await fetch(url, {\r\n        method: 'GET'\r\n    });\r\n\r\n    var result = await response.json();\r\n\r\n    return result;\r\n}\r\n\r\nconst fetchPost = async (url, body) => {\r\n    var response = await fetch(url, {\r\n        method: 'POST',\r\n        headers: {\r\n            'Accept': 'application/json',\r\n            \"Content-type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(body)\r\n    }).then(result => result)\r\n\r\n    return response;\r\n}\r\n\n\n//# sourceURL=webpack://wwwroot/./js/fetchHelper.js?")}},r=>{var n;n="./js/adminConteudo.js",r(r.s=n)}]);